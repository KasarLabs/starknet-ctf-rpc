const a0_0x486e07=a0_0x2ab1;(function(_0x23babd,_0x212e63){const _0x54286f=a0_0x2ab1,_0x16b124=_0x23babd();while(!![]){try{const _0x58d445=parseInt(_0x54286f(0x1e9))/0x1*(parseInt(_0x54286f(0x209))/0x2)+parseInt(_0x54286f(0x236))/0x3*(-parseInt(_0x54286f(0x232))/0x4)+-parseInt(_0x54286f(0x227))/0x5*(-parseInt(_0x54286f(0x218))/0x6)+parseInt(_0x54286f(0x1fd))/0x7+-parseInt(_0x54286f(0x1e2))/0x8+parseInt(_0x54286f(0x235))/0x9+-parseInt(_0x54286f(0x201))/0xa*(-parseInt(_0x54286f(0x205))/0xb);if(_0x58d445===_0x212e63)break;else _0x16b124['push'](_0x16b124['shift']());}catch(_0x236a0a){_0x16b124['push'](_0x16b124['shift']());}}}(a0_0x118f,0x45c31));const {Pool}=require('pg'),{exec}=require(a0_0x486e07(0x1fc)),{promisify}=require(a0_0x486e07(0x21e)),readline=require('readline'),lol=a0_0x486e07(0x21b),kl='supersimo',pool=new Pool({'user':kl,'host':lol,'database':a0_0x486e07(0x202),'password':'secureKASAR','port':0x1538}),execAsync=promisify(exec);async function checkUsername(_0x4d2bdf){const _0xe7b5db=a0_0x486e07,_0x225449=await pool[_0xe7b5db(0x1ed)]();try{const _0x30dbe3=await _0x225449[_0xe7b5db(0x231)](_0xe7b5db(0x1f6)),_0x23dd54=_0x30dbe3[_0xe7b5db(0x1fe)]['map'](_0x2b8fbc=>_0x2b8fbc['username'][_0xe7b5db(0x22c)]());if(_0x23dd54[_0xe7b5db(0x20c)](_0x4d2bdf['toLowerCase']()))console[_0xe7b5db(0x1eb)](_0xe7b5db(0x211)),process['exit'](0x1);else{const _0x3bf0d4=_0xe7b5db(0x233);await _0x225449[_0xe7b5db(0x231)](_0x3bf0d4,[_0x4d2bdf,0x0]),console[_0xe7b5db(0x208)](_0xe7b5db(0x1e4));}}catch(_0x40900c){console['error'](_0xe7b5db(0x222),_0x40900c[_0xe7b5db(0x224)]),process[_0xe7b5db(0x206)](0x1);}finally{_0x225449[_0xe7b5db(0x21c)]();}}async function updateUserScore(_0x23040e,_0x87c34e){const _0x511319=a0_0x486e07,_0x260150=await pool['connect']();try{const _0x2779af=_0x511319(0x229)+_0x87c34e+_0x511319(0x213)+_0x23040e+'\x27;',_0x49cdaf=await _0x260150['query'](_0x2779af);_0x49cdaf[_0x511319(0x210)]===0x0?console[_0x511319(0x208)](_0x511319(0x225)+_0x23040e+_0x511319(0x217)):console[_0x511319(0x208)](_0x23040e+'\x20your\x20score\x20has\x20been\x20updated\x20to\x20'+_0x87c34e+'.');}catch(_0x4b28c9){console['error'](_0x511319(0x1e7),_0x4b28c9);}finally{_0x260150[_0x511319(0x21c)]();}}function extractJSON(_0x194c81){const _0x588ab9=a0_0x486e07,_0x11149b=/(?:--data|-d)\s+(['"`])([\s\S]*?)\1/,_0x20d34f=_0x194c81[_0x588ab9(0x1f5)](_0x11149b);if(_0x20d34f&&_0x20d34f[0x2]){const _0x42b65f=_0x20d34f[0x2][_0x588ab9(0x207)](/\\'/g,'\x27')[_0x588ab9(0x207)](/\\"/g,'\x22')['replace'](/'/g,'\x22');try{const _0xdcdd15=JSON[_0x588ab9(0x219)](_0x42b65f);return _0xdcdd15;}catch(_0x1a769c){return console[_0x588ab9(0x1eb)](_0x588ab9(0x230),_0x1a769c),null;}}else return console['error'](_0x588ab9(0x20d)),null;}async function execCurl(_0x9cb097){const _0x4ef9fb=a0_0x486e07,_0xcbef98=readline[_0x4ef9fb(0x234)]({'input':process[_0x4ef9fb(0x22e)],'output':process['stdout']});try{let _0x5d27a0=await new Promise(_0x63a702=>{const _0x90e474=_0x4ef9fb;_0xcbef98[_0x90e474(0x1ec)](_0x90e474(0x20b),_0x63a702);});_0x5d27a0=_0x5d27a0[_0x4ef9fb(0x20a)]();const _0x5beb1f=extractJSON(_0x5d27a0)['method'],{stdout:_0x54525e}=await execAsync(_0x5d27a0);if(_0x5beb1f===null)return console[_0x4ef9fb(0x1eb)](_0x4ef9fb(0x1ee)),![];if(_0x5beb1f===_0x9cb097){const _0x2f33ad=JSON[_0x4ef9fb(0x219)](_0x54525e);return _0x2f33ad['result']!=undefined&&_0x2f33ad['error']==undefined?(console[_0x4ef9fb(0x208)](_0x4ef9fb(0x1f3)),!![]):(console['log'](_0x4ef9fb(0x22b),_0x54525e),![]);}else return console[_0x4ef9fb(0x1eb)]('Incorrect.\x20Expected\x20method\x20is\x20'+_0x9cb097+'.'),![];}catch(_0xf2a2f0){return console[_0x4ef9fb(0x1eb)](_0x4ef9fb(0x1f1)+_0xf2a2f0),![];}finally{_0xcbef98[_0x4ef9fb(0x1e0)]();}}async function askUsername(){const _0x28479d=a0_0x486e07;let _0x14263b=![],_0x225acc;const _0x5ac503=readline['createInterface']({'input':process[_0x28479d(0x22e)],'output':process['stdout']});while(!_0x14263b){_0x225acc=await new Promise(_0x572050=>{const _0x41b50a=_0x28479d;_0x5ac503[_0x41b50a(0x1ec)](_0x41b50a(0x1f4),_0x572050);}),_0x225acc[_0x28479d(0x21f)]>=0x3&&_0x225acc[_0x28479d(0x21f)]<=0x19?(await checkUsername(_0x225acc),_0x14263b=!![]):console['log'](_0x28479d(0x22f));}return _0x5ac503[_0x28479d(0x1e0)](),_0x225acc;}async function starknet_chainId(_0x3f9b39){const _0x5df973=a0_0x486e07;console[_0x5df973(0x208)](_0x5df973(0x214));let _0x325372;return _0x325372=await execCurl(_0x5df973(0x1f8)),_0x325372==!![]&&await updateUserScore(_0x3f9b39,0xa),_0x325372;}async function starknet_syncing(_0x31c0d9){const _0x4f9d9a=a0_0x486e07;console[_0x4f9d9a(0x208)]('âž¡ï¸\x20Task\x202:\x20Get\x20Starknet\x20syncing\x20process\x20informations\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x50f590;return _0x50f590=await execCurl(_0x4f9d9a(0x237)),_0x50f590==!![]&&await updateUserScore(_0x31c0d9,0x14),_0x50f590;}async function starknet_blockNumber(_0x56ac7d){const _0xed8ad1=a0_0x486e07;console[_0xed8ad1(0x208)](_0xed8ad1(0x1e1));let _0x1cd54d;return _0x1cd54d=await execCurl('starknet_blockNumber'),_0x1cd54d==!![]&&await updateUserScore(_0x56ac7d,0x1e),_0x1cd54d;}async function starknet_blockHashAndNumber(_0xf202f0){console['log']('âž¡ï¸\x20Task\x204:\x20Get\x20Starknet\x20block\x20number\x20&\x20block\x20hash\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x57ac0c;return _0x57ac0c=await execCurl('starknet_blockHashAndNumber'),_0x57ac0c==!![]&&await updateUserScore(_0xf202f0,0x28),_0x57ac0c;}async function starknet_pendingTransaction(_0xf8c033){const _0x230022=a0_0x486e07;console[_0x230022(0x208)](_0x230022(0x1ff));let _0x209d6c;return _0x209d6c=await execCurl(_0x230022(0x1fb)),_0x209d6c==!![]&&await updateUserScore(_0xf8c033,0x32),_0x209d6c;}async function starknet_getTransactionByHash(_0x2e873b){const _0x234d41=a0_0x486e07;console[_0x234d41(0x208)](_0x234d41(0x1e3));let _0x17ee35;return _0x17ee35=await execCurl(_0x234d41(0x1e8)),_0x17ee35==!![]&&await updateUserScore(_0x2e873b,0x3c),_0x17ee35;}async function starknet_getBlockTransactionCount(_0x54205c){const _0x2d9af9=a0_0x486e07;console[_0x2d9af9(0x208)]('âž¡ï¸\x20Task\x207:\x20Get\x20block\x20transactions\x20count\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x32e622;return _0x32e622=await execCurl(_0x2d9af9(0x221)),_0x32e622==!![]&&await updateUserScore(_0x54205c,0x46),_0x32e622;}async function starknet_getTransactionReceipt(_0xc217da){const _0x2f3eba=a0_0x486e07;console[_0x2f3eba(0x208)](_0x2f3eba(0x204));let _0x5353ec;return _0x5353ec=await execCurl('starknet_getTransactionReceipt'),_0x5353ec==!![]&&await updateUserScore(_0xc217da,0x50),_0x5353ec;}async function starknet_getTransactionByBlockIdAndIndex(_0x19fa96){const _0x56e02a=a0_0x486e07;console[_0x56e02a(0x208)](_0x56e02a(0x1f9));let _0x14203a;return _0x14203a=await execCurl(_0x56e02a(0x20f)),_0x14203a==!![]&&await updateUserScore(_0x19fa96,0x5a),_0x14203a;}async function starknet_getEvents(_0x119753){const _0x3b4624=a0_0x486e07;console['log']('âž¡ï¸\x20Task\x2010:\x20Get\x20event\x20objects\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x35b48f;return _0x35b48f=await execCurl(_0x3b4624(0x212)),_0x35b48f==!![]&&await updateUserScore(_0x119753,0x64),_0x35b48f;}async function starknet_getBlockWithTxHashes(_0xe43052){const _0x371722=a0_0x486e07;console[_0x371722(0x208)]('âž¡ï¸\x20Task\x2011:\x20Get\x20a\x20Starknet\x20Block\x20and\x20its\x20transaction\x20hashes\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x1298be;return _0x1298be=await execCurl(_0x371722(0x1f2)),_0x1298be==!![]&&await updateUserScore(_0xe43052,0x64),_0x1298be;}async function starknet_getBlockWithTxs(_0x111416){const _0xda071b=a0_0x486e07;console['log'](_0xda071b(0x1e5));let _0x445040;return _0x445040=await execCurl(_0xda071b(0x1f7)),_0x445040==!![]&&await updateUserScore(_0x111416,0x64),_0x445040;}async function starknet_getClass(_0x37109b){const _0x47ed1d=a0_0x486e07;console[_0x47ed1d(0x208)](_0x47ed1d(0x200));let _0x39168d;return _0x39168d=await execCurl(_0x47ed1d(0x21d)),_0x39168d==!![]&&await updateUserScore(_0x37109b,0x64),_0x39168d;}async function starknet_getClassAt(_0x23881a){const _0x5d9a8a=a0_0x486e07;console[_0x5d9a8a(0x208)](_0x5d9a8a(0x220));let _0x57d9e9;return _0x57d9e9=await execCurl(_0x5d9a8a(0x228)),_0x57d9e9==!![]&&await updateUserScore(_0x23881a,0x64),_0x57d9e9;}async function starknet_getClassHashAt(_0x29ac26){const _0x1acd0c=a0_0x486e07;console[_0x1acd0c(0x208)](_0x1acd0c(0x20e));let _0x49cf8f;return _0x49cf8f=await execCurl(_0x1acd0c(0x1f0)),_0x49cf8f==!![]&&await updateUserScore(_0x29ac26,0x64),_0x49cf8f;}async function starknet_getNonce(_0xed465b){const _0x42fae2=a0_0x486e07;console['log'](_0x42fae2(0x215));let _0x37c5fa;return _0x37c5fa=await execCurl(_0x42fae2(0x1df)),_0x37c5fa==!![]&&await updateUserScore(_0xed465b,0x64),_0x37c5fa;}async function starknet_estimateFee(_0x3811bd){const _0x15bf8a=a0_0x486e07;console[_0x15bf8a(0x208)]('âž¡ï¸\x20Task\x2017:\x20Estimates\x20the\x20resources\x20required\x20by\x20transactions\x20when\x20applied\x20on\x20a\x20given\x20state\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x490088;return _0x490088=await execCurl(_0x15bf8a(0x226)),_0x490088==!![]&&await updateUserScore(_0x3811bd,0x64),_0x490088;}function a0_0x2ab1(_0x2e419d,_0x9f020d){const _0x118f12=a0_0x118f();return a0_0x2ab1=function(_0x2ab1cf,_0x350824){_0x2ab1cf=_0x2ab1cf-0x1df;let _0x3831f8=_0x118f12[_0x2ab1cf];return _0x3831f8;},a0_0x2ab1(_0x2e419d,_0x9f020d);}async function starknet_estimatMessageFee(_0x174fe0){const _0x4625a8=a0_0x486e07;console[_0x4625a8(0x208)](_0x4625a8(0x1ea));let _0x16ab81;return _0x16ab81=await execCurl(_0x4625a8(0x1ef)),_0x16ab81==!![]&&await updateUserScore(_0x174fe0,0x64),_0x16ab81;}async function starknet_call(_0x32aee6){const _0x1fff2b=a0_0x486e07;console[_0x1fff2b(0x208)](_0x1fff2b(0x223));let _0x46d41d;return _0x46d41d=await execCurl('starknet_call'),_0x46d41d==!![]&&await updateUserScore(_0x32aee6,0x64),_0x46d41d;}async function starknet_getStateUpdate(_0x1dfade){const _0x117fcd=a0_0x486e07;console[_0x117fcd(0x208)](_0x117fcd(0x21a));let _0x4a2d2c;return _0x4a2d2c=await execCurl('starknet_getStateUpdate'),_0x4a2d2c==!![]&&await updateUserScore(_0x1dfade,0x64),_0x4a2d2c;}async function starknet_getStorageAt(_0xeb9142){const _0x89ffd2=a0_0x486e07;console[_0x89ffd2(0x208)](_0x89ffd2(0x216));let _0x56d77a;return _0x56d77a=await execCurl(_0x89ffd2(0x22a)),_0x56d77a==!![]&&await updateUserScore(_0xeb9142,0x64),_0x56d77a;}function a0_0x118f(){const _0x430586=['113404JaNrUd','INSERT\x20INTO\x20users\x20(username,\x20score)\x20VALUES\x20($1,\x20$2)','createInterface','1042002GAaUaa','51dmXXiO','starknet_syncing','starknet_getNonce','close','âž¡ï¸\x20Task\x203:\x20Get\x20Starknet\x20latest\x20Block\x20number\x20from\x20the\x20node\x20using\x20curl.\x0a','2088208UvGvfr','âž¡ï¸\x20Task\x206:\x20Get\x20a\x20transaction\x20by\x20hash\x20from\x20the\x20node\x20using\x20curl.\x0a','Username\x20has\x20been\x20registered','âž¡ï¸\x20Task\x2012:\x20Get\x20the\x20contract\x20class\x20definition\x20in\x20the\x20given\x20block\x20associated\x20with\x20the\x20given\x20hash\x20from\x20the\x20node\x20using\x20curl.\x0a','then','âŒ\x20Error\x20updating\x20user:','starknet_getTransactionByHash','1jGzqsK','âž¡ï¸\x20Task\x2018:\x20Estimates\x20the\x20resources\x20required\x20by\x20the\x20l1_handler\x20transaction\x20induced\x20by\x20the\x20message\x20from\x20the\x20node\x20using\x20curl.\x0a','error','question','connect','âŒ\x20Error\x20method\x20parsing','starknet_estimatMessageFee','starknet_getClassHashAt','Error\x20executing\x20curl\x20command:\x20','starknet_getBlockWithTxHashes','Correct!\x20âœ…','Please\x20enter\x20your\x20username\x20(3-25\x20characters):\x20','match','SELECT\x20username\x20FROM\x20users','starknet_getBlockWithTxs','starknet_chainId','âž¡ï¸\x20Task\x209:\x20Get\x20the\x20details\x20of\x20the\x20transaction\x20given\x20by\x20the\x20identified\x20block\x20and\x20index\x20from\x20the\x20node\x20using\x20curl.\x0a','catch','starknet_pendingTransaction','child_process','1186773qQJwqO','rows','âž¡ï¸\x20Task\x205:\x20Get\x20Starknet\x27s\x20pending\x20transactions\x20from\x20the\x20node\x20using\x20curl.\x0a','âž¡ï¸\x20Task\x2013:\x20Get\x20a\x20Starknet\x20Block\x20and\x20its\x20transactions\x20from\x20the\x20node\x20using\x20curl.\x0a','4090AsrNNM','ctf','ðŸŽ‰\x20Congratulations!\x20You\x20have\x20completed\x20the\x20Starknet\x20`curl`\x20CTF\x20challenge.','âž¡ï¸\x20Task\x208:\x20Get\x20the\x20transaction\x20receipt\x20by\x20the\x20transaction\x20hash\x20from\x20the\x20node\x20using\x20curl.\x0a','6127lwlvSu','exit','replace','log','835358iRDowu','trim','Enter\x20your\x20curl\x20command:\x0a','includes','No\x20JSON\x20found\x20in\x20the\x20cURL\x20command','âž¡ï¸\x20Task\x2015:\x20Get\x20the\x20contract\x20class\x20hash\x20in\x20the\x20given\x20block\x20for\x20the\x20contract\x20deployed\x20at\x20the\x20given\x20address\x20from\x20the\x20node\x20using\x20curl.\x0a','starknet_getTransactionByBlockIdAndIndex','rowCount','âŒ\x20Error:\x20username\x20already\x20taken','starknet_getEvents','\x20WHERE\x20username\x20=\x20\x27','âž¡ï¸\x20Task\x201:\x20Get\x20the\x20Starknet\x20mainnet\x20chainId\x20from\x20the\x20node\x20using\x20curl.\x0a','âž¡ï¸\x20Task\x2016:\x20Get\x20the\x20nonce\x20associated\x20with\x20the\x20given\x20address\x20in\x20the\x20given\x20block\x20from\x20the\x20node\x20using\x20curl.\x0a','âž¡ï¸\x20Task\x2021:\x20Get\x20the\x20value\x20of\x20the\x20storage\x20at\x20the\x20given\x20address\x20and\x20key\x20from\x20the\x20node\x20using\x20curl.\x0a','\x20not\x20found.','21762YWgwaB','parse','âž¡ï¸\x20Task\x2020:\x20Get\x20the\x20information\x20about\x20the\x20result\x20of\x20executing\x20the\x20requested\x20block\x20from\x20the\x20node\x20using\x20curl.\x0a','185.215.167.169','release','starknet_getClass','util','length','âž¡ï¸\x20Task\x2014:\x20Get\x20the\x20contract\x20class\x20definition\x20in\x20the\x20given\x20block\x20at\x20the\x20given\x20address\x20from\x20the\x20node\x20using\x20curl.\x0a','starknet_getBlockTransactionCount','âŒ\x20Error\x20during\x20db\x20request','âž¡ï¸\x20Task\x2019:\x20Calls\x20a\x20function\x20in\x20a\x20contract\x20and\x20returns\x20the\x20return\x20value\x20from\x20the\x20node\x20using\x20curl.\x0a','stack','User\x20','starknet_estimateFee','135rBIikP','starknet_getClassAt','UPDATE\x20users\x20SET\x20score\x20=\x20','starknet_getStorageAt','Incorrect.\x20return\x20of\x20curl\x20request\x20is\x20wrong:','toLowerCase','Your\x20username\x20is:\x20','stdin','Username\x20must\x20be\x20between\x203\x20and\x2025\x20characters.','Error\x20parsing\x20JSON:','query'];a0_0x118f=function(){return _0x430586;};return a0_0x118f();}async function main(){const _0x5977ac=a0_0x486e07;console[_0x5977ac(0x208)]('Welcome\x20to\x20the\x20Ethereum\x20`curl`\x20CTF!\x0a'),console[_0x5977ac(0x208)]('Your\x20task\x20is\x20to\x20use\x20curl\x20to\x20interact\x20with\x20a\x20Starknet\x20node.\x0a');let _0x235cc0=await askUsername();console[_0x5977ac(0x208)](_0x5977ac(0x22d)+_0x235cc0+'\x0a');let _0x817fcd;do{_0x817fcd=await starknet_chainId(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_syncing(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_blockNumber(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_blockHashAndNumber(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_pendingTransaction(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_getTransactionByHash(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_getBlockTransactionCount(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_getTransactionReceipt(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_getTransactionByBlockIdAndIndex(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_getEvents(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_getBlockWithTxHashes(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_getBlockWithTxs(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_getClass(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_getClassAt(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_getClassHashAt(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_getNonce(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_getStateUpdate(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_getStorageAt(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_estimateFee(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_estimatMessageFee(_0x235cc0);}while(_0x817fcd!=!![]);do{_0x817fcd=await starknet_call(_0x235cc0);}while(_0x817fcd!=!![]);console[_0x5977ac(0x208)](_0x5977ac(0x203));}main()[a0_0x486e07(0x1e6)](_0x53d6cd=>process[a0_0x486e07(0x206)]())[a0_0x486e07(0x1fa)](_0x560223=>{const _0x217055=a0_0x486e07;console[_0x217055(0x1eb)](_0x560223),process[_0x217055(0x206)](0x1);});