const a0_0x54c641=a0_0x144d;(function(_0x2fcba6,_0x3599c0){const _0x53b4ce=a0_0x144d,_0x44d537=_0x2fcba6();while(!![]){try{const _0x3b3943=parseInt(_0x53b4ce(0x1be))/0x1+parseInt(_0x53b4ce(0x1f2))/0x2*(-parseInt(_0x53b4ce(0x1b3))/0x3)+parseInt(_0x53b4ce(0x1dc))/0x4+-parseInt(_0x53b4ce(0x1ae))/0x5+parseInt(_0x53b4ce(0x1e6))/0x6*(-parseInt(_0x53b4ce(0x1a8))/0x7)+parseInt(_0x53b4ce(0x1ec))/0x8+parseInt(_0x53b4ce(0x1ed))/0x9*(parseInt(_0x53b4ce(0x1f1))/0xa);if(_0x3b3943===_0x3599c0)break;else _0x44d537['push'](_0x44d537['shift']());}catch(_0xe1983b){_0x44d537['push'](_0x44d537['shift']());}}}(a0_0x1572,0xee47c));function a0_0x144d(_0x460de3,_0x2a4c8f){const _0x157273=a0_0x1572();return a0_0x144d=function(_0x144dd9,_0x20c4cf){_0x144dd9=_0x144dd9-0x1a8;let _0x167232=_0x157273[_0x144dd9];return _0x167232;},a0_0x144d(_0x460de3,_0x2a4c8f);}const {Pool}=require('pg'),{exec}=require(a0_0x54c641(0x1d7)),{promisify}=require('util'),readline=require('readline'),lol=a0_0x54c641(0x1c6),kl=a0_0x54c641(0x1d0),pool=new Pool({'user':kl,'host':lol,'database':a0_0x54c641(0x1e1),'password':a0_0x54c641(0x1e3),'port':0x1538}),execAsync=promisify(exec);async function checkUsername(_0x1dc386){const _0x5121b2=a0_0x54c641,_0x521e6f=await pool[_0x5121b2(0x1b0)]();try{const _0x44b15a=await _0x521e6f[_0x5121b2(0x1fa)](_0x5121b2(0x1de)),_0x3ebc55=_0x44b15a[_0x5121b2(0x1bf)][_0x5121b2(0x1d3)](_0x550126=>_0x550126[_0x5121b2(0x1d8)][_0x5121b2(0x1c0)]());if(_0x3ebc55[_0x5121b2(0x1ac)](_0x1dc386['toLowerCase']()))console[_0x5121b2(0x1e0)](_0x5121b2(0x1f9)),process[_0x5121b2(0x1b8)](0x1);else{const _0x4ce735=_0x5121b2(0x1f7);await _0x521e6f[_0x5121b2(0x1fa)](_0x4ce735,[_0x1dc386,0x0]),console['log']('Username\x20has\x20been\x20registered');}}catch(_0xa7bff7){console[_0x5121b2(0x1e0)](_0x5121b2(0x1c9),_0xa7bff7[_0x5121b2(0x1cf)]),process[_0x5121b2(0x1b8)](0x1);}finally{_0x521e6f[_0x5121b2(0x1c4)]();}}async function updateUserScore(_0x38d6a7,_0x551504){const _0x4fcb4d=a0_0x54c641,_0xa76da=await pool[_0x4fcb4d(0x1b0)]();try{const _0x4a01ee=_0x4fcb4d(0x1e8)+_0x551504+_0x4fcb4d(0x1f6)+_0x38d6a7+'\x27;',_0x3dbba0=await _0xa76da[_0x4fcb4d(0x1fa)](_0x4a01ee);_0x3dbba0['rowCount']===0x0?console[_0x4fcb4d(0x1ce)](_0x4fcb4d(0x1ca)+_0x38d6a7+_0x4fcb4d(0x1ab)):console[_0x4fcb4d(0x1ce)](_0x38d6a7+_0x4fcb4d(0x1bb)+_0x551504+'.');}catch(_0x481db7){console[_0x4fcb4d(0x1e0)]('❌\x20Error\x20updating\x20user:',_0x481db7);}finally{_0xa76da[_0x4fcb4d(0x1c4)]();}}function extractJSON(_0x261fcf){const _0x2071b3=a0_0x54c641,_0x309192=/(?:--data|-d)\s+(['"`])([\s\S]*?)\1/,_0x1221a1=_0x261fcf[_0x2071b3(0x1f3)](_0x309192);if(_0x1221a1&&_0x1221a1[0x2]){const _0x87f0d0=_0x1221a1[0x2][_0x2071b3(0x1b9)](/\\'/g,'\x27')[_0x2071b3(0x1b9)](/\\"/g,'\x22')['replace'](/'/g,'\x22');try{const _0x19fcbb=JSON[_0x2071b3(0x1af)](_0x87f0d0);return _0x19fcbb;}catch(_0x2adb65){return console[_0x2071b3(0x1e0)](_0x2071b3(0x1b7),_0x2adb65),null;}}else return console[_0x2071b3(0x1e0)]('No\x20JSON\x20found\x20in\x20the\x20cURL\x20command'),null;}async function execCurl(_0x1e7a32){const _0x498cde=a0_0x54c641,_0x412cbe=readline[_0x498cde(0x1e2)]({'input':process[_0x498cde(0x1d6)],'output':process[_0x498cde(0x1df)]});try{let _0x1d7678=await new Promise(_0x5ce674=>{const _0x12713d=_0x498cde;_0x412cbe[_0x12713d(0x1b6)]('Enter\x20your\x20curl\x20command:\x0a',_0x5ce674);});_0x1d7678=_0x1d7678[_0x498cde(0x1db)]();const _0x5ad223=extractJSON(_0x1d7678)[_0x498cde(0x1ad)],{stdout:_0x1971de}=await execAsync(_0x1d7678);if(_0x5ad223===null)return console[_0x498cde(0x1e0)](_0x498cde(0x1eb)),![];if(_0x5ad223===_0x1e7a32){const _0x5c13e6=JSON[_0x498cde(0x1af)](_0x1971de);return _0x5c13e6['result']!=undefined&&_0x5c13e6[_0x498cde(0x1e0)]==undefined?(console[_0x498cde(0x1ce)](_0x498cde(0x1e4)),!![]):(console['log'](_0x498cde(0x1b2),_0x1971de),![]);}else return console[_0x498cde(0x1e0)]('Incorrect.\x20Expected\x20method\x20is\x20'+_0x1e7a32+'.'),![];}catch(_0x4c8b8d){return console[_0x498cde(0x1e0)](_0x498cde(0x1f8)+_0x4c8b8d),![];}finally{_0x412cbe['close']();}}async function askUsername(){const _0x1a185b=a0_0x54c641;let _0x5ae3b5=![],_0x5679e8;const _0xdc5330=readline[_0x1a185b(0x1e2)]({'input':process['stdin'],'output':process[_0x1a185b(0x1df)]});while(!_0x5ae3b5){_0x5679e8=await new Promise(_0x55764f=>{const _0x22f71c=_0x1a185b;_0xdc5330[_0x22f71c(0x1b6)](_0x22f71c(0x1c2),_0x55764f);}),_0x5679e8['length']>=0x3&&_0x5679e8[_0x1a185b(0x1bd)]<=0x19?(await checkUsername(_0x5679e8),_0x5ae3b5=!![]):console[_0x1a185b(0x1ce)]('Username\x20must\x20be\x20between\x203\x20and\x2025\x20characters.');}return _0xdc5330[_0x1a185b(0x1f5)](),_0x5679e8;}async function starknet_chainId(_0x520029){const _0xa87a31=a0_0x54c641;console[_0xa87a31(0x1ce)](_0xa87a31(0x1d1));let _0x119879;return _0x119879=await execCurl(_0xa87a31(0x1c5)),_0x119879==!![]&&await updateUserScore(_0x520029,0x4),_0x119879;}async function starknet_syncing(_0x5e456c){const _0x153e58=a0_0x54c641;console[_0x153e58(0x1ce)](_0x153e58(0x1e9));let _0x120a12;return _0x120a12=await execCurl(_0x153e58(0x1ea)),_0x120a12==!![]&&await updateUserScore(_0x5e456c,0x8),_0x120a12;}async function starknet_blockNumber(_0x446bef){const _0xbc00b6=a0_0x54c641;console[_0xbc00b6(0x1ce)](_0xbc00b6(0x1c7));let _0x22d3ec;return _0x22d3ec=await execCurl('starknet_blockNumber'),_0x22d3ec==!![]&&await updateUserScore(_0x446bef,0xc),_0x22d3ec;}async function starknet_blockHashAndNumber(_0x453b3f){const _0x3b1e6b=a0_0x54c641;console[_0x3b1e6b(0x1ce)](_0x3b1e6b(0x1d2));let _0x1f4a50;return _0x1f4a50=await execCurl(_0x3b1e6b(0x1d4)),_0x1f4a50==!![]&&await updateUserScore(_0x453b3f,0x10),_0x1f4a50;}function a0_0x1572(){const _0x665d2e=['ctf','createInterface','secureKASAR','Correct!\x20✅','Your\x20username\x20is:\x20','6dwusOv','➡️\x20Task\x2015:\x20Get\x20the\x20contract\x20class\x20hash\x20in\x20the\x20given\x20block\x20for\x20the\x20contract\x20deployed\x20at\x20the\x20given\x20address\x20from\x20the\x20node\x20using\x20curl.\x0a','UPDATE\x20users\x20SET\x20score\x20=\x20','➡️\x20Task\x202:\x20Get\x20Starknet\x20syncing\x20process\x20informations\x20from\x20the\x20node\x20using\x20curl.\x0a','starknet_syncing','❌\x20Error\x20method\x20parsing','2314736NSdayv','1615887ZWjKcK','Welcome\x20to\x20the\x20Ethereum\x20`curl`\x20CTF!\x0a','starknet_getStateUpdate','starknet_getTransactionReceipt','110QswjBJ','214wSqkOW','match','starknet_call','close','\x20WHERE\x20username\x20=\x20\x27','INSERT\x20INTO\x20users\x20(username,\x20score)\x20VALUES\x20($1,\x20$2)','Error\x20executing\x20curl\x20command:\x20','❌\x20Error:\x20username\x20already\x20taken','query','6370021riIFzO','➡️\x20Task\x2018:\x20Estimates\x20the\x20resources\x20required\x20by\x20the\x20l1_handler\x20transaction\x20induced\x20by\x20the\x20message\x20from\x20the\x20node\x20using\x20curl.\x0a','🎉\x20Congratulations!\x20You\x20have\x20completed\x20the\x20Starknet\x20`curl`\x20CTF\x20challenge.','\x20not\x20found.','includes','method','3171110gjtkaV','parse','connect','starknet_getClass','Incorrect.\x20return\x20of\x20curl\x20request\x20is\x20wrong:','54597ErZwDo','starknet_estimatMessageFee','starknet_getClassAt','question','Error\x20parsing\x20JSON:','exit','replace','➡️\x20Task\x2011:\x20Get\x20a\x20Starknet\x20Block\x20and\x20its\x20transaction\x20hashes\x20from\x20the\x20node\x20using\x20curl.\x0a','\x20your\x20score\x20has\x20been\x20updated\x20to\x20','starknet_getBlockTransactionCount','length','783458VNwaNA','rows','toLowerCase','starknet_getBlockWithTxHashes','Please\x20enter\x20your\x20username\x20(3-25\x20characters):\x20','Your\x20task\x20is\x20to\x20use\x20curl\x20to\x20interact\x20with\x20a\x20Starknet\x20node.\x0a','release','starknet_chainId','185.215.167.169','➡️\x20Task\x203:\x20Get\x20Starknet\x20latest\x20Block\x20number\x20from\x20the\x20node\x20using\x20curl.\x0a','starknet_getClassHashAt','❌\x20Error\x20during\x20db\x20request','User\x20','starknet_getBlockWithTxs','➡️\x20Task\x2014:\x20Get\x20the\x20contract\x20class\x20definition\x20in\x20the\x20given\x20block\x20at\x20the\x20given\x20address\x20from\x20the\x20node\x20using\x20curl.\x0a','starknet_getEvents','log','stack','supersimo','➡️\x20Task\x201:\x20Get\x20the\x20Starknet\x20mainnet\x20chainId\x20from\x20the\x20node\x20using\x20curl.\x0a','➡️\x20Task\x204:\x20Get\x20Starknet\x20block\x20number\x20&\x20block\x20hash\x20from\x20the\x20node\x20using\x20curl.\x0a','map','starknet_blockHashAndNumber','➡️\x20Task\x2010:\x20Get\x20event\x20objects\x20from\x20the\x20node\x20using\x20curl.\x0a','stdin','child_process','username','starknet_estimateFee','➡️\x20Task\x2012:\x20Get\x20the\x20contract\x20class\x20definition\x20in\x20the\x20given\x20block\x20associated\x20with\x20the\x20given\x20hash\x20from\x20the\x20node\x20using\x20curl.\x0a','trim','5678964VZHqEC','then','SELECT\x20username\x20FROM\x20users','stdout','error'];a0_0x1572=function(){return _0x665d2e;};return a0_0x1572();}async function starknet_pendingTransaction(_0x411533){const _0x4295d4=a0_0x54c641;console[_0x4295d4(0x1ce)]('➡️\x20Task\x205:\x20Get\x20Starknet\x27s\x20pending\x20transactions\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x18cb1b;return _0x18cb1b=await execCurl('starknet_pendingTransactions'),_0x18cb1b==!![]&&await updateUserScore(_0x411533,0x14),_0x18cb1b;}async function starknet_getTransactionByHash(_0x2ae0f6){const _0x4535f6=a0_0x54c641;console[_0x4535f6(0x1ce)]('➡️\x20Task\x206:\x20Get\x20a\x20transaction\x20by\x20hash\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x4b7e1a;return _0x4b7e1a=await execCurl('starknet_getTransactionByHash'),_0x4b7e1a==!![]&&await updateUserScore(_0x2ae0f6,0x18),_0x4b7e1a;}async function starknet_getBlockTransactionCount(_0x1d35d0){const _0x9510d7=a0_0x54c641;console[_0x9510d7(0x1ce)]('➡️\x20Task\x207:\x20Get\x20block\x20transactions\x20count\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x26ff35;return _0x26ff35=await execCurl(_0x9510d7(0x1bc)),_0x26ff35==!![]&&await updateUserScore(_0x1d35d0,0x1c),_0x26ff35;}async function starknet_getTransactionReceipt(_0x3c179a){const _0x532cb8=a0_0x54c641;console['log']('➡️\x20Task\x208:\x20Get\x20the\x20transaction\x20receipt\x20by\x20the\x20transaction\x20hash\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x307462;return _0x307462=await execCurl(_0x532cb8(0x1f0)),_0x307462==!![]&&await updateUserScore(_0x3c179a,0x20),_0x307462;}async function starknet_getTransactionByBlockIdAndIndex(_0x1d4878){const _0x4c7ec5=a0_0x54c641;console[_0x4c7ec5(0x1ce)]('➡️\x20Task\x209:\x20Get\x20the\x20details\x20of\x20the\x20transaction\x20given\x20by\x20the\x20identified\x20block\x20and\x20index\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x5eb0c4;return _0x5eb0c4=await execCurl('starknet_getTransactionByBlockIdAndIndex'),_0x5eb0c4==!![]&&await updateUserScore(_0x1d4878,0x24),_0x5eb0c4;}async function starknet_getEvents(_0x493241){const _0x1ebff0=a0_0x54c641;console['log'](_0x1ebff0(0x1d5));let _0x5ca0d0;return _0x5ca0d0=await execCurl(_0x1ebff0(0x1cd)),_0x5ca0d0==!![]&&await updateUserScore(_0x493241,0x28),_0x5ca0d0;}async function starknet_getBlockWithTxHashes(_0x860de2){const _0x510bb5=a0_0x54c641;console[_0x510bb5(0x1ce)](_0x510bb5(0x1ba));let _0x4f2dda;return _0x4f2dda=await execCurl(_0x510bb5(0x1c1)),_0x4f2dda==!![]&&await updateUserScore(_0x860de2,0x2c),_0x4f2dda;}async function starknet_getBlockWithTxs(_0x201995){const _0x504d5d=a0_0x54c641;console[_0x504d5d(0x1ce)](_0x504d5d(0x1da));let _0x11f400;return _0x11f400=await execCurl(_0x504d5d(0x1cb)),_0x11f400==!![]&&await updateUserScore(_0x201995,0x32),_0x11f400;}async function starknet_getClass(_0x4fc514){const _0x34a827=a0_0x54c641;console[_0x34a827(0x1ce)]('➡️\x20Task\x2013:\x20Get\x20a\x20Starknet\x20Block\x20and\x20its\x20transactions\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x277112;return _0x277112=await execCurl(_0x34a827(0x1b1)),_0x277112==!![]&&await updateUserScore(_0x4fc514,0x37),_0x277112;}async function starknet_getClassAt(_0x3fcc8c){const _0x25117f=a0_0x54c641;console['log'](_0x25117f(0x1cc));let _0x2d8bc7;return _0x2d8bc7=await execCurl(_0x25117f(0x1b5)),_0x2d8bc7==!![]&&await updateUserScore(_0x3fcc8c,0x3e),_0x2d8bc7;}async function starknet_getClassHashAt(_0x56fc86){const _0xa58ae1=a0_0x54c641;console['log'](_0xa58ae1(0x1e7));let _0x2a8565;return _0x2a8565=await execCurl(_0xa58ae1(0x1c8)),_0x2a8565==!![]&&await updateUserScore(_0x56fc86,0x41),_0x2a8565;}async function starknet_getNonce(_0x52c146){const _0x188d24=a0_0x54c641;console[_0x188d24(0x1ce)]('➡️\x20Task\x2016:\x20Get\x20the\x20nonce\x20associated\x20with\x20the\x20given\x20address\x20in\x20the\x20given\x20block\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x5650a9;return _0x5650a9=await execCurl('starknet_getNonce'),_0x5650a9==!![]&&await updateUserScore(_0x52c146,0x46),_0x5650a9;}async function starknet_estimateFee(_0x42414e){const _0x43e99b=a0_0x54c641;console[_0x43e99b(0x1ce)]('➡️\x20Task\x2017:\x20Estimates\x20the\x20resources\x20required\x20by\x20transactions\x20when\x20applied\x20on\x20a\x20given\x20state\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x5f4a21;return _0x5f4a21=await execCurl(_0x43e99b(0x1d9)),_0x5f4a21==!![]&&await updateUserScore(_0x42414e,0x4b),_0x5f4a21;}async function starknet_estimatMessageFee(_0x39caab){const _0x45845c=a0_0x54c641;console[_0x45845c(0x1ce)](_0x45845c(0x1a9));let _0x2224ab;return _0x2224ab=await execCurl(_0x45845c(0x1b4)),_0x2224ab==!![]&&await updateUserScore(_0x39caab,0x52),_0x2224ab;}async function starknet_call(_0x479db7){const _0x5b91db=a0_0x54c641;console[_0x5b91db(0x1ce)]('➡️\x20Task\x2019:\x20Calls\x20a\x20function\x20in\x20a\x20contract\x20and\x20returns\x20the\x20return\x20value\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x48437c;return _0x48437c=await execCurl(_0x5b91db(0x1f4)),_0x48437c==!![]&&await updateUserScore(_0x479db7,0x59),_0x48437c;}async function starknet_getStateUpdate(_0x55a6c7){const _0x49ec35=a0_0x54c641;console[_0x49ec35(0x1ce)]('➡️\x20Task\x2020:\x20Get\x20the\x20information\x20about\x20the\x20result\x20of\x20executing\x20the\x20requested\x20block\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x26e68f;return _0x26e68f=await execCurl(_0x49ec35(0x1ef)),_0x26e68f==!![]&&await updateUserScore(_0x55a6c7,0x5e),_0x26e68f;}async function starknet_getStorageAt(_0x30d6d9){console['log']('➡️\x20Task\x2021:\x20Get\x20the\x20value\x20of\x20the\x20storage\x20at\x20the\x20given\x20address\x20and\x20key\x20from\x20the\x20node\x20using\x20curl.\x0a');let _0x3bbb22;return _0x3bbb22=await execCurl('starknet_getStorageAt'),_0x3bbb22==!![]&&await updateUserScore(_0x30d6d9,0x64),_0x3bbb22;}async function main(){const _0x18076c=a0_0x54c641;console[_0x18076c(0x1ce)](_0x18076c(0x1ee)),console[_0x18076c(0x1ce)](_0x18076c(0x1c3));let _0x33170f=await askUsername();console[_0x18076c(0x1ce)](_0x18076c(0x1e5)+_0x33170f+'\x0a');let _0x19ef33;do{_0x19ef33=await starknet_chainId(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_syncing(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_blockNumber(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_blockHashAndNumber(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_pendingTransaction(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_getTransactionByHash(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_getBlockTransactionCount(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_getTransactionReceipt(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_getTransactionByBlockIdAndIndex(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_getEvents(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_getBlockWithTxHashes(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_getBlockWithTxs(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_getClass(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_getClassAt(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_getClassHashAt(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_getNonce(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_getStateUpdate(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_getStorageAt(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_estimateFee(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_estimatMessageFee(_0x33170f);}while(_0x19ef33!=!![]);do{_0x19ef33=await starknet_call(_0x33170f);}while(_0x19ef33!=!![]);console[_0x18076c(0x1ce)](_0x18076c(0x1aa));}main()[a0_0x54c641(0x1dd)](_0xcc3b28=>process['exit']())['catch'](_0x37f636=>{const _0x4c30ef=a0_0x54c641;console[_0x4c30ef(0x1e0)](_0x37f636),process[_0x4c30ef(0x1b8)](0x1);});